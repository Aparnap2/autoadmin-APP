# Test: Morning Briefing Generation
appId: com.autoadmin.app

---
# Setup
- runFlow:
    file: ../utils/helpers.yaml
    args:
      message: "Starting Morning Briefing Test"

- tapOn:
    text: "Dashboard"
    label: "Navigate to Dashboard tab"

- waitFor:
    id: "dashboard-container"
    timeout: 10000

---
# Test 1: Generate Morning Briefing
- tapOn:
    text: "Generate Morning Briefing"
    label: "Tap generate briefing button"

# Wait for briefing generation
- waitFor:
    text: "Executive Summary"
    timeout: 60000

# Assert key briefing sections
- assertVisible:
    text: "Key Metrics"
    regex: true

- assertVisible:
    text: "Revenue"
    regex: true

- assertVisible:
    text: "Customers"
    regex: true

- assertVisible:
    text: "Pipeline"
    regex: true

---
# Test 2: Validate Revenue Metrics
- scrollUntilVisible:
    element:
      text: "Revenue"
    regex: true
    direction: DOWN
    timeout: 5000

# Assert revenue data
- assertVisible:
    text: "\\$"
    regex: true

- assertVisible:
    text: "growth"
    regex: true

---
# Test 3: Check Customer Metrics
- assertVisible:
    text: "customers"
    regex: true

# Assert customer data
- assertVisible:
    text: "acquisition"
    regex: true

- assertVisible:
    text: "churn"
    regex: true

---
# Test 4: Validate Pipeline Health
- scrollUntilVisible:
    element:
      text: "Pipeline"
    regex: true
    direction: DOWN
    timeout: 5000

# Assert pipeline metrics
- assertVisible:
    text: "ratio"
    regex: true

- assertVisible:
    text: "quota"
    regex: true

---
# Test 5: Check Alerts Section
- scrollUntilVisible:
    element:
      text: "Alerts"
    direction: DOWN
    timeout: 5000

# Verify alerts are displayed (if any)
# Check for alert indicators
- extendedWaitUntil:
    visible:
      text: "alert"
      regex: true
    timeout: 3000

---
# Test 6: Validate Growth Opportunities
- scrollUntilVisible:
    element:
      text: "Opportunities"
    regex: true
    direction: DOWN
    timeout: 5000

# Assert opportunities section
- assertVisible:
    text: "growth"
    regex: true

---
# Test 7: Check Recommendations
- scrollUntilVisible:
    element:
      text: "Recommendations"
    regex: true
    direction: DOWN
    timeout: 5000

# Verify recommendations exist
- assertVisible:
    text: "strategic"
    regex: true

---
# Test 8: Refresh Briefing
- tapOn:
    text: "Refresh"
    label: "Tap refresh button"

# Wait for refresh
- waitFor:
    text: "Executive Summary"
    timeout: 45000

# Assert updated timestamp
- assertVisible:
    text: "Updated"
    regex: true

---
# Test 9: Share Briefing
- tapOn:
    text: "Share"
    label: "Tap share button"

# Verify share options appear
- assertVisible:
    text: "Export"
    regex: true

- tapOn:
    text: "Export"
    label: "Export briefing"

# Wait for export completion
- waitFor:
    text: "exported"
    timeout: 15000

- runFlow:
    file: ../../utils/helpers.yaml
    args:
      message: "Morning Briefing Test Completed Successfully"