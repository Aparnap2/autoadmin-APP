# Test: Revenue Intelligence Analysis
appId: com.autoadmin.app

---
# Setup
- runFlow:
    file: ../utils/helpers.yaml
    args:
      message: "Starting Revenue Intelligence Test"

- tapOn:
    text: "Dashboard"
    label: "Navigate to Dashboard tab"

- waitFor:
    id: "dashboard-container"
    timeout: 10000

---
# Test 1: Navigate to Revenue Intelligence
- scrollUntilVisible:
    element:
      text: "Revenue Intelligence"
    direction: DOWN
    timeout: 5000

- tapOn:
    text: "Revenue Intelligence"
    label: "Open Revenue Intelligence"

# Wait for revenue data to load
- waitFor:
    text: "Revenue Analysis"
    timeout: 45000

---
# Test 2: Validate Revenue Dashboard
- assertVisible:
    text: "Total Revenue"
    regex: true

- assertVisible:
    text: "MRR"
    regex: true  # Monthly Recurring Revenue

- assertVisible:
    text: "ARR"
    regex: true  # Annual Recurring Revenue

- assertVisible:
    text: "Growth Rate"
    regex: true

---
# Test 3: Check Revenue Trends
- scrollUntilVisible:
    element:
      text: "Revenue Trends"
    direction: DOWN
    timeout: 5000

# Assert trend visualization
- assertVisible:
    text: "chart"
    id: "revenue-chart"

# Assert trend indicators
- assertVisible:
    text: "trend"
    regex: true

- assertVisible:
    text: "period"
    regex: true

---
# Test 4: Validate Revenue Breakdown
- scrollUntilVisible:
    element:
      text: "Revenue Breakdown"
    direction: DOWN
    timeout: 5000

# Check for revenue segments
- assertVisible:
    text: "Segments"
    regex: true

- assertVisible:
    text: "Products"
    regex: true

- assertVisible:
    text: "Services"
    regex: true

---
# Test 5: Check Customer Segments
- scrollUntilVisible:
    element:
      text: "Customer Segments"
    direction: DOWN
    timeout: 5000

# Assert segment data
- assertVisible:
    text: "Enterprise"
    regex: true

- assertVisible:
    text: "SMB"
    regex: true

---
# Test 6: Validate Revenue Forecasts
- scrollUntilVisible:
    element:
      text: "Forecast"
    regex: true
    direction: DOWN
    timeout: 5000

- assertVisible:
    text: "predicted"
    regex: true

- assertVisible:
    text: "confidence"
    regex: true

---
# Test 7: Test Revenue Analysis Agent
- tapOn:
    text: "Ask Revenue Agent"
    label: "Tap Revenue Agent button"

- tapOn:
    id: "revenue-chat-input"
    label: "Focus revenue chat input"

- inputText: "What's driving our revenue growth this month?"

- tapOn:
    text: "Send"
    label: "Send revenue question"

# Wait for agent response
- waitFor:
    text: "growth drivers"
    timeout: 45000

# Assert response quality
- assertVisible:
    text: "increase"
    regex: true

- assertVisible:
    text: "factors"
    regex: true

---
# Test 8: Test Revenue Comparison
- tapOn:
    text: "Compare Periods"
    label: "Tap compare periods"

- tapOn:
    text: "Last Month"
    label: "Select last month comparison"

# Wait for comparison data
- waitFor:
    text: "comparison"
    timeout: 15000

- assertVisible:
    text: "vs"
    regex: true

---
# Test 9: Export Revenue Report
- tapOn:
    text: "Export Report"
    label: "Export revenue report"

- tapOn:
    text: "PDF"
    label: "Select PDF format"

# Wait for export
- waitFor:
    text: "Report exported"
    timeout: 30000

- runFlow:
    file: ../../utils/helpers.yaml
    args:
      message: "Revenue Intelligence Test Completed Successfully"